	.ORIG	x3000
NSHOW	LD	R0, ENTER
	OUT
SHOW	LEA	R0, ROWA
	PUTS
	LD	R1, ANUM
	JSR	N
	LEA	R0, ROWB
	PUTS
	LD	R1, BNUM
	JSR	N
	LEA	R0, ROWC
	PUTS
	LD	R1, CNUM
	JSR	N
	LD	R6, CON
	BRz	P2
	BRnp	P1
P1W	LD	R0, ENTER
	OUT
	LEA	R0, WRONG
	PUTS
	LD	R0, ENTER
	OUT
P1	LD	R1, ANUM
	BRnp	NP1
	LD	R1, BNUM
	BRnp	NP1
	LD	R1, CNUM
	BRz	WIN
NP1	AND	R6, R6, #0
	ST	R6, CON
	LEA	R0, P1P
	PUTS
	GETC
	OUT
	ADD	R1, R0, #0
	GETC
	OUT
	ADD	R2, R0, #0
	ADD	R2, R2, #-16
	ADD	R2, R2, #-16
	ADD	R2, R2, #-16
	BRnz	P1W
	NOT	R2, R2
	ADD	R2, R2, #1
	AND	R3, R3, #0
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-1
	AND	R4, R4, #0
	ADD	R4, R4, #3
CHECK1	BRz	P1W
	ADD	R5, R1, R3
	BRz	A
	ADD	R3, R3, #-1
	ADD	R4, R4, #-1
	BRnzp	CHECK1
A	ADD	R5, R4, #-3
	BRnp	B
	LD	R4, ANUM
	ADD	R4, R4, R2
	BRn	R
	ST	R4, ANUM
	BR	NSHOW
B	ADD	R5, R4, #-2
	BRnp	C
	LD	R4, BNUM
	ADD	R4, R4, R2
	BRn	R
	ST	R4, BNUM
	BR	NSHOW
C	LD	R4, CNUM
	ADD	R4, R4, R2
	BRn	R
	ST	R4, CNUM
	BR	NSHOW
R	LD	R6, CON
	BRnp	P2W
	BRz	P1W
ROWA	.STRINGZ	"ROW A: "
ROWB	.STRINGZ	"ROW B: "
ROWC	.STRINGZ	"ROW C: "
ANUM	.FILL		x0003
BNUM	.FILL		x0005
CNUM	.FILL		x0008
ENTER	.FILL		x000A
P1P	.STRINGZ	"Player 1, choose a row and number of rocks: "
P2P	.STRINGZ	"Player 2, choose a row and number of rocks: "
WRONG	.STRINGZ	"Invalid move. Try again. "
STONE	.FILL		x006F
CON	.FILL		x0001
WIN	LD	R6, CON
	BRz	PWIN2
	BRnp	PWIN1
PWIN1	LD	R0, ENTER
	OUT
	LEA	R0, WIN1
	PUTS
	HALT
PWIN2	LD	R0, ENTER
	OUT
	LEA	R0, WIN2
	PUTS
	HALT
P2W	LD	R0, ENTER
	OUT
	LEA	R0, WRONG
	PUTS
	LD	R0, ENTER
	OUT
P2	LD	R1, ANUM
	BRnp	NP2
	LD	R1, BNUM
	BRnp	NP2
	LD	R1, CNUM
	BRz	WIN
NP2	AND	R6, R6, #0
	ADD	R6, R6, #1
	ST	R6, CON
	LEA	R0, P2P
	PUTS
	GETC
	OUT
	ADD	R1, R0, #0
	GETC
	OUT
	ADD	R2, R0, #0
	ADD	R2, R2, #-16
	ADD	R2, R2, #-16
	ADD	R2, R2, #-16
	BRnz	P2W
	NOT	R2, R2
	ADD	R2, R2, #1
	AND	R3, R3, #0
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-16
	ADD	R3, R3, #-1
	AND	R4, R4, #0
	ADD	R4, R4, #3
CHECK2	BRz	P2W
	ADD	R5, R1, R3
	BRz	A
	ADD	R3, R3, #-1
	ADD	R4, R4, #-1
	BRnzp	CHECK2
WIN1	.STRINGZ	"Player 1 Wins. "
WIN2	.STRINGZ	"Player 2 Wins. "
N	ADD	R6, R7, #0
	ADD	R1, R1, #0
O	BRz	DONE
	LD	R0, STONE
	OUT
	ADD	R1, R1, #-1
	BRnzp	O
DONE	LD	R0, ENTER
	OUT
	JMP	R6
	.END